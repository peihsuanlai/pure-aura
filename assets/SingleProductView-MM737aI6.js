import{a as j}from"./axios-L6U4YIEh.js";import{_ as J,r as I,o as y,c as k,d as C,w as x,F as N,i as z,s as R,b as i,h as O,a as Q,t as _,j as $,g as V,n as F,e as U,l as q}from"./index-6kkLmJOv.js";import{c as W}from"./cartStore-rk_UojvA.js";import{g as Z,i as ee,e as te,n as B,a as D,N as se,S as ie,b as ne,C as oe}from"./CarouselComponent-ENb0dmGu.js";import{s as G}from"./alertHelper-rCyq43OB.js";function re(r){let{swiper:e,extendParams:T,on:b}=r;T({thumbs:{swiper:null,multipleActiveThumbs:!0,autoScrollOffset:0,slideThumbActiveClass:"swiper-slide-thumb-active",thumbsContainerClass:"swiper-thumbs"}});let n=!1,f=!1;e.thumbs={swiper:null};function w(){const s=e.thumbs.swiper;if(!s||s.destroyed)return;const t=s.clickedIndex,c=s.clickedSlide;if(c&&c.classList.contains(e.params.thumbs.slideThumbActiveClass)||typeof t>"u"||t===null)return;let d;s.params.loop?d=parseInt(s.clickedSlide.getAttribute("data-swiper-slide-index"),10):d=t,e.params.loop?e.slideToLoop(d):e.slideTo(d)}function v(){const{thumbs:s}=e.params;if(n)return!1;n=!0;const t=e.constructor;if(s.swiper instanceof t)e.thumbs.swiper=s.swiper,Object.assign(e.thumbs.swiper.originalParams,{watchSlidesProgress:!0,slideToClickedSlide:!1}),Object.assign(e.thumbs.swiper.params,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper.update();else if(ee(s.swiper)){const c=Object.assign({},s.swiper);Object.assign(c,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper=new t(c),f=!0}return e.thumbs.swiper.el.classList.add(e.params.thumbs.thumbsContainerClass),e.thumbs.swiper.on("tap",w),!0}function u(s){const t=e.thumbs.swiper;if(!t||t.destroyed)return;const c=t.params.slidesPerView==="auto"?t.slidesPerViewDynamic():t.params.slidesPerView;let d=1;const a=e.params.thumbs.slideThumbActiveClass;if(e.params.slidesPerView>1&&!e.params.centeredSlides&&(d=e.params.slidesPerView),e.params.thumbs.multipleActiveThumbs||(d=1),d=Math.floor(d),t.slides.forEach(m=>m.classList.remove(a)),t.params.loop||t.params.virtual&&t.params.virtual.enabled)for(let m=0;m<d;m+=1)te(t.slidesEl,`[data-swiper-slide-index="${e.realIndex+m}"]`).forEach(l=>{l.classList.add(a)});else for(let m=0;m<d;m+=1)t.slides[e.realIndex+m]&&t.slides[e.realIndex+m].classList.add(a);const p=e.params.thumbs.autoScrollOffset,S=p&&!t.params.loop;if(e.realIndex!==t.realIndex||S){const m=t.activeIndex;let l,M;if(t.params.loop){const o=t.slides.find(P=>P.getAttribute("data-swiper-slide-index")===`${e.realIndex}`);l=t.slides.indexOf(o),M=e.activeIndex>e.previousIndex?"next":"prev"}else l=e.realIndex,M=l>e.previousIndex?"next":"prev";S&&(l+=M==="next"?p:-1*p),t.visibleSlidesIndexes&&t.visibleSlidesIndexes.indexOf(l)<0&&(t.params.centeredSlides?l>m?l=l-Math.floor(c/2)+1:l=l+Math.floor(c/2)-1:l>m&&t.params.slidesPerGroup,t.slideTo(l,s?0:void 0))}}b("beforeInit",()=>{const{thumbs:s}=e.params;if(!(!s||!s.swiper))if(typeof s.swiper=="string"||s.swiper instanceof HTMLElement){const t=Z(),c=()=>{const a=typeof s.swiper=="string"?t.querySelector(s.swiper):s.swiper;if(a&&a.swiper)s.swiper=a.swiper,v(),u(!0);else if(a){const p=`${e.params.eventsPrefix}init`,S=m=>{s.swiper=m.detail[0],a.removeEventListener(p,S),v(),u(!0),s.swiper.update(),e.update()};a.addEventListener(p,S)}return a},d=()=>{if(e.destroyed)return;c()||requestAnimationFrame(d)};requestAnimationFrame(d)}else v(),u(!0)}),b("slideChange update resize observerUpdate",()=>{u()}),b("setTransition",(s,t)=>{const c=e.thumbs.swiper;!c||c.destroyed||c.setTransition(t)}),b("beforeDestroy",()=>{const s=e.thumbs.swiper;!s||s.destroyed||f&&s.destroy()}),Object.assign(e.thumbs,{init:v,update:u})}function le(r){let{swiper:e,extendParams:T,emit:b,once:n}=r;T({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function f(){if(e.params.cssMode)return;const u=e.getTranslate();e.setTranslate(u),e.setTransition(0),e.touchEventsData.velocities.length=0,e.freeMode.onTouchEnd({currentPos:e.rtl?e.translate:-e.translate})}function w(){if(e.params.cssMode)return;const{touchEventsData:u,touches:s}=e;u.velocities.length===0&&u.velocities.push({position:s[e.isHorizontal()?"startX":"startY"],time:u.touchStartTime}),u.velocities.push({position:s[e.isHorizontal()?"currentX":"currentY"],time:B()})}function v(u){let{currentPos:s}=u;if(e.params.cssMode)return;const{params:t,wrapperEl:c,rtlTranslate:d,snapGrid:a,touchEventsData:p}=e,m=B()-p.touchStartTime;if(s<-e.minTranslate()){e.slideTo(e.activeIndex);return}if(s>-e.maxTranslate()){e.slides.length<a.length?e.slideTo(a.length-1):e.slideTo(e.slides.length-1);return}if(t.freeMode.momentum){if(p.velocities.length>1){const h=p.velocities.pop(),g=p.velocities.pop(),K=h.position-g.position,H=h.time-g.time;e.velocity=K/H,e.velocity/=2,Math.abs(e.velocity)<t.freeMode.minimumVelocity&&(e.velocity=0),(H>150||B()-h.time>300)&&(e.velocity=0)}else e.velocity=0;e.velocity*=t.freeMode.momentumVelocityRatio,p.velocities.length=0;let l=1e3*t.freeMode.momentumRatio;const M=e.velocity*l;let o=e.translate+M;d&&(o=-o);let P=!1,E;const A=Math.abs(e.velocity)*20*t.freeMode.momentumBounceRatio;let L;if(o<e.maxTranslate())t.freeMode.momentumBounce?(o+e.maxTranslate()<-A&&(o=e.maxTranslate()-A),E=e.maxTranslate(),P=!0,p.allowMomentumBounce=!0):o=e.maxTranslate(),t.loop&&t.centeredSlides&&(L=!0);else if(o>e.minTranslate())t.freeMode.momentumBounce?(o-e.minTranslate()>A&&(o=e.minTranslate()+A),E=e.minTranslate(),P=!0,p.allowMomentumBounce=!0):o=e.minTranslate(),t.loop&&t.centeredSlides&&(L=!0);else if(t.freeMode.sticky){let h;for(let g=0;g<a.length;g+=1)if(a[g]>-o){h=g;break}Math.abs(a[h]-o)<Math.abs(a[h-1]-o)||e.swipeDirection==="next"?o=a[h]:o=a[h-1],o=-o}if(L&&n("transitionEnd",()=>{e.loopFix()}),e.velocity!==0){if(d?l=Math.abs((-o-e.translate)/e.velocity):l=Math.abs((o-e.translate)/e.velocity),t.freeMode.sticky){const h=Math.abs((d?-o:o)-e.translate),g=e.slidesSizesGrid[e.activeIndex];h<g?l=t.speed:h<2*g?l=t.speed*1.5:l=t.speed*2.5}}else if(t.freeMode.sticky){e.slideToClosest();return}t.freeMode.momentumBounce&&P?(e.updateProgress(E),e.setTransition(l),e.setTranslate(o),e.transitionStart(!0,e.swipeDirection),e.animating=!0,D(c,()=>{!e||e.destroyed||!p.allowMomentumBounce||(b("momentumBounce"),e.setTransition(t.speed),setTimeout(()=>{e.setTranslate(E),D(c,()=>{!e||e.destroyed||e.transitionEnd()})},0))})):e.velocity?(b("_freeModeNoMomentumRelease"),e.updateProgress(o),e.setTransition(l),e.setTranslate(o),e.transitionStart(!0,e.swipeDirection),e.animating||(e.animating=!0,D(c,()=>{!e||e.destroyed||e.transitionEnd()}))):e.updateProgress(o),e.updateActiveIndex(),e.updateSlidesClasses()}else if(t.freeMode.sticky){e.slideToClosest();return}else t.freeMode&&b("_freeModeNoMomentumRelease");(!t.freeMode.momentum||m>=t.longSwipesMs)&&(b("_freeModeStaticRelease"),e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses())}Object.assign(e,{freeMode:{onTouchStart:f,onTouchMove:w,onTouchEnd:v}})}const ae={props:{images:{type:Array,default:()=>[]}},data(){return{thumbsSwiper:null,modules:[se,re,le]}},methods:{setThumbsSwiper(r){this.thumbsSwiper=r}},components:{Swiper:ie,SwiperSlide:ne}},ue={class:"item"},ce={class:"item"};function de(r,e,T,b,n,f){const w=I("SwiperSlide"),v=I("Swiper");return y(),k(N,null,[C(v,{modules:n.modules,thumbs:{swiper:n.thumbsSwiper},navigation:!0,class:"product-main-swiper"},{default:x(()=>[(y(!0),k(N,null,z(T.images,(u,s)=>(y(),R(w,{key:s},{default:x(()=>[i("div",ue,[i("div",{class:"img",style:O({backgroundImage:`url(${u})`})},null,4)])]),_:2},1024))),128))]),_:1},8,["modules","thumbs"]),C(v,{modules:n.modules,class:"product-thumb-swiper",spaceBetween:"10",slidesPerView:"5",watchSlidesProgress:!0,freeMode:!0,onSwiper:f.setThumbsSwiper},{default:x(()=>[(y(!0),k(N,null,z(T.images,(u,s)=>(y(),R(w,{key:"thumb-"+s},{default:x(()=>[i("div",ce,[i("div",{class:"img",style:O({backgroundImage:`url(${u})`})},null,4)])]),_:2},1024))),128))]),_:1},8,["modules","onSwiper"])],64)}const me=J(ae,[["render",de]]);var pe={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"product-api",BASE_URL:"/pure-aura/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:X,VITE_API_PATH:Y}=pe,fe={data(){return{product:{},productId:null,contentType:"intro",productNum:1,recommendProduct:[]}},methods:{formateText(r){return(r||"").replace(/\n/g,"<br>")},changeNum(r){r==="minus"?this.productNum-=1:r==="plus"&&(this.productNum+=1)},getProduct(r){j.get(`${X}/api/${Y}/product/${r}`).then(e=>{this.product=e.data.product,this.getRecommendProducts(this.product.category)}).catch(e=>{G(e.response.data.message,!1),this.$router.push("/products")})},getRecommendProducts(r){j.get(`${X}/api/${Y}/products?category=${r}`).then(e=>{const{products:T}=e.data;this.recommendProduct=T}).catch(()=>{G()})},...Q(W,["addToCart"])},watch:{"$route.params.id":{handler(r){this.getProduct(r)},immediate:!0}},components:{ProductImageCarousel:me,CarouselComponent:oe},mounted(){this.productId=this.$route.params.id,this.getProduct(this.productId)}},he={class:"single-product-page no-banner"},be={class:"container mb-5"},ve={"aria-label":"breadcrumb"},we={class:"breadcrumb"},ge={class:"breadcrumb-item"},Te=["textContent"],_e={key:0,class:"row top"},ye={class:"col-md-7 col-lg-6","data-origin":"left"},xe={class:"col-md-5 offset-lg-1 reveal","data-origin":"right"},Se={class:"py-md-3 py-lg-5 d-flex h-100 flex-column justify-content-between"},Ce=["textContent"],Me=["textContent"],Pe=["innerHTML"],Ie={class:"top-price"},ke=["textContent"],Ee=["textContent"],Ae={class:"number-box mb-3"},Ve=["disabled"],Le=["textContent"],Ne={class:"action-btns"},Be={class:"list-unstyled tablink reveal","data-origin":"top"},De={class:"container reveal"},Re=["innerHTML"],Oe=["innerHTML"],He={class:"container"},je={class:"product-carousel product-list reveal"},ze=["textContent"],$e={class:"price"},Fe=["textContent"],Ue=["textContent"],qe=["onClick"];function Ge(r,e,T,b,n,f){const w=I("RouterLink"),v=I("ProductImageCarousel"),u=I("CarouselComponent");return y(),k("main",he,[i("div",be,[i("nav",ve,[i("ol",we,[e[6]||(e[6]=i("li",{class:"breadcrumb-item"},[i("a",{href:"/"},"首頁")],-1)),i("li",ge,[C(w,{to:"/products"},{default:x(()=>e[5]||(e[5]=[V("全系列商品")])),_:1})]),i("li",{class:"breadcrumb-item active","aria-current":"page",textContent:_(n.product.title)},null,8,Te)])]),n.product.title?(y(),k("div",_e,[i("div",ye,[Array.isArray(n.product.imagesUrl)?(y(),R(v,{key:0,images:n.product.imagesUrl},null,8,["images"])):$("",!0)]),i("div",xe,[i("div",Se,[i("div",null,[i("h4",{textContent:_(n.product.category)},null,8,Ce),i("h2",{textContent:_(n.product.title)},null,8,Me),i("div",{innerHTML:f.formateText(n.product.description),class:"des"},null,8,Pe),i("div",Ie,[i("span",{class:"original-price",textContent:_("NT$"+r.$filter.currency(n.product.origin_price))},null,8,ke),i("span",{class:"offer-price",textContent:_("NT$"+r.$filter.currency(n.product.price))},null,8,Ee)]),i("div",Ae,[i("button",{type:"button",onClick:e[0]||(e[0]=s=>f.changeNum("minus")),disabled:n.productNum===1},e[7]||(e[7]=[i("i",{class:"bi bi-dash-lg"},null,-1)]),8,Ve),i("span",{textContent:_(n.productNum)},null,8,Le),i("button",{type:"button",onClick:e[1]||(e[1]=s=>f.changeNum("plus"))},e[8]||(e[8]=[i("i",{class:"bi bi-plus-lg"},null,-1)]))])]),i("div",Ne,[i("button",{type:"button",onClick:e[2]||(e[2]=s=>r.addToCart(n.product.id,n.productNum))},e[9]||(e[9]=[i("i",{class:"bi bi-cart3"},null,-1),V(" 加入購物車")])),C(w,{to:"/cart"},{default:x(()=>e[10]||(e[10]=[i("i",{class:"bi bi-bag-check"},null,-1),V(" 直接購物")])),_:1})])])])])):$("",!0)]),i("ul",Be,[i("li",null,[i("button",{type:"button",class:F({active:n.contentType=="intro"}),onClick:e[3]||(e[3]=s=>n.contentType="intro")},"產品介紹",2)]),i("li",null,[i("button",{type:"button",class:F({active:n.contentType=="spec"}),onClick:e[4]||(e[4]=s=>n.contentType="spec")},"產品規格",2)])]),i("div",De,[U(i("div",{class:"tabcontent",innerHTML:f.formateText(n.product.content)},null,8,Re),[[q,n.contentType=="intro"]]),U(i("div",{class:"tabcontent",innerHTML:f.formateText(n.product.spec)},null,8,Oe),[[q,n.contentType=="spec"]])]),i("div",He,[i("div",je,[e[13]||(e[13]=i("h3",{class:"recommend-title reveal","data-origin":"top"},"你可能有興趣...",-1)),C(u,{slides:n.recommendProduct,slidesPerView:1,spaceBetween:0,loop:!1,autoplay:!1,pagination:!1,breakpoints:{576:{slidesPerView:2,spaceBetween:20},992:{slidesPerView:3,spaceBetween:20}}},{default:x(({item:s})=>[C(w,{to:{name:"Product",params:{id:s.id}},class:"item"},{default:x(()=>[i("div",{class:"img",style:O({backgroundImage:`url(${s.imageUrl})`})},e[11]||(e[11]=[i("div",{class:"overlay"},[i("div",null,"查看細節")],-1)]),4),i("h4",{class:"product-title",textContent:_(s.title)},null,8,ze),i("div",$e,[i("span",{class:"original-price",textContent:_("NT$"+r.$filter.currency(s.origin_price))},null,8,Fe),i("span",{class:"offer-price",textContent:_("NT$"+r.$filter.currency(s.price))},null,8,Ue)])]),_:2},1032,["to"]),i("button",{type:"button",class:"add-btn",onClick:t=>r.addToCart(s.id)},e[12]||(e[12]=[i("i",{class:"bi bi-cart3"},null,-1),V(" 加入購物車 ")]),8,qe)]),_:1},8,["slides"])])])])}const We=J(fe,[["render",Ge]]);export{We as default};
