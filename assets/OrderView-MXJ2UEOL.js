import{a as b}from"./axios-L6U4YIEh.js";import{s as w,D as P}from"./DeleteModal-aYiTQTev.js";import{M as L}from"./bootstrap.esm-XuB0aUZE.js";import{_ as y,o as s,c as n,b as t,t as l,j as _,F as p,i as m,r as c,d as h,e as D,v as V}from"./index-FCRSNV6O.js";import{P as S}from"./PaginationComponent-wu4xN3U5.js";const E={props:{order:{type:Object,default:()=>({})}},data(){return{orderModal:null,tempOrder:{}}},watch:{order(){this.tempOrder=this.order}},methods:{openModal(){this.orderModal.show()},closeModal(){this.orderModal.hide()}},mounted(){this.orderModal=new L(this.$refs.orderModal),this.tempOrder=this.order}},I={class:"modal fade",id:"orderModal",ref:"orderModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},U={class:"modal-dialog modal-xl",role:"document"},A={class:"modal-content border-0"},T={class:"modal-body"},R={class:"row"},B={class:"col-md-4"},N={class:"table"},j={key:0},q={class:"col-md-8"},F={class:"table"},H={key:0},z={key:1},G={key:0,class:"text-success"},J={key:1,class:"text-muted"},K={class:"table"},Q={class:"text-end"};function W(d,e,O,v,o,u){return s(),n("div",I,[t("div",U,[t("div",A,[e[13]||(e[13]=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{class:"modal-title",id:"exampleModalLabel"},[t("span",null,"訂單細節")]),t("button",{type:"button",class:"btn text-white","data-bs-dismiss":"modal","aria-label":"Close"},[t("i",{class:"bi bi-x-lg"})])],-1)),t("div",T,[t("div",R,[t("div",B,[e[4]||(e[4]=t("h3",null,"收件人",-1)),t("table",N,[o.tempOrder.user?(s(),n("tbody",j,[t("tr",null,[e[0]||(e[0]=t("th",{style:{width:"100px"}},"姓名",-1)),t("td",null,l(o.tempOrder.user.name),1)]),t("tr",null,[e[1]||(e[1]=t("th",null,"信箱",-1)),t("td",null,l(o.tempOrder.user.email),1)]),t("tr",null,[e[2]||(e[2]=t("th",null,"電話",-1)),t("td",null,l(o.tempOrder.user.tel),1)]),t("tr",null,[e[3]||(e[3]=t("th",null,"地址",-1)),t("td",null,l(o.tempOrder.user.address),1)])])):_("",!0)])]),t("div",q,[e[11]||(e[11]=t("h3",null,"訂單細節",-1)),t("table",F,[t("tbody",null,[t("tr",null,[e[5]||(e[5]=t("th",{style:{width:"100px"}},"訂單編號",-1)),t("td",null,l(o.tempOrder.id),1)]),t("tr",null,[e[6]||(e[6]=t("th",null,"下單時間",-1)),t("td",null,l(d.$filter.date(o.tempOrder.create_at)),1)]),t("tr",null,[e[7]||(e[7]=t("th",null,"付款時間",-1)),t("td",null,[o.tempOrder.paid_date?(s(),n("span",H,l(d.$filter.date(o.tempOrder.paid_date)),1)):(s(),n("span",z,"--"))])]),t("tr",null,[e[8]||(e[8]=t("th",null,"付款狀態",-1)),t("td",null,[o.tempOrder.is_paid?(s(),n("strong",G,"已付款")):(s(),n("span",J,"尚未付款"))])]),t("tr",null,[e[9]||(e[9]=t("th",null,"總金額",-1)),t("td",null,l(d.$filter.currency(o.tempOrder.total)),1)])])]),e[12]||(e[12]=t("h3",null,"商品",-1)),t("table",K,[e[10]||(e[10]=t("thead",null,[t("tr")],-1)),t("tbody",null,[(s(!0),n(p,null,m(o.tempOrder.products,a=>(s(),n("tr",{key:a.id},[t("th",null,l(a.product.title),1),t("td",null,l(a.qty)+" "+l(a.product.unit),1),t("td",Q,l(d.$filter.currency(a.final_total)),1)]))),128))])])])])]),e[14]||(e[14]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-light","data-bs-dismiss":"modal"},"取消 ")],-1))])])],512)}const X=y(E,[["render",W]]);var Y={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"product-api",BASE_URL:"/pure-aura/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:f,VITE_API_PATH:g}=Y,Z={data(){return{type:"order",orders:[],pagination:{},isLoading:!0,tempOrder:{},currentPage:1}},methods:{getOrders(d=1){this.currentPage=d,b.get(`${f}/api/${g}/admin/orders?page=${d}`).then(e=>{this.orders=e.data.orders,this.pagination=e.data.pagination,this.isLoading=!1})},openModal(d,e){this.tempOrder={...e},d==="view"?this.$refs.modalOrder.openModal():d==="delete"&&this.$refs.modalDelete.openModal()},updatePaid(d){const e={is_paid:d.is_paid};b.put(`${f}/api/${g}/admin/order/${d.id}`,{data:e}).then(()=>{this.isLoading=!1,this.getOrders(this.currentPage),w("付款狀態更新")})}},components:{DeleteModal:P,OrderModal:X,PaginationComponent:S},mounted(){this.getOrders()}},tt={class:"container"},et={class:"table mt-4"},ot={key:0},lt=["textContent"],st={key:0},nt=["textContent"],rt={key:1},dt=["textContent"],it={class:"list-unstyled"},at=["textContent"],ut={class:"form-check form-switch"},pt=["id","onUpdate:modelValue","onChange"],ct=["for"],ht={key:0},_t={key:1},mt={class:"btn-group"},bt=["onClick"],ft=["onClick"];function gt(d,e,O,v,o,u){const a=c("PaginationComponent"),M=c("LoadingOverlay"),k=c("OrderModal"),x=c("DeleteModal");return s(),n(p,null,[t("div",tt,[t("table",et,[e[1]||(e[1]=t("thead",null,[t("tr",null,[t("th",null,"時間"),t("th",null,"姓名"),t("th",null,"信箱"),t("th",null,"品項"),t("th",null,"總金額"),t("th",null,"是否付款"),t("th",null,"編輯")])],-1)),t("tbody",null,[(s(!0),n(p,null,m(o.orders,(r,C)=>(s(),n(p,{key:C},[o.orders.length?(s(),n("tr",ot,[t("td",{textContent:l(d.$filter.date(r.create_at))},null,8,lt),r.user?(s(),n("td",st,[t("span",{textContent:l(r.user.name)},null,8,nt)])):_("",!0),r.user?(s(),n("td",rt,[t("span",{textContent:l(r.user.email)},null,8,dt)])):_("",!0),t("td",null,[t("ul",it,[(s(!0),n(p,null,m(r.products,(i,$)=>(s(),n("li",{key:$},l(i.product.title)+" 數量："+l(i.qty)+" "+l(i.product.unit),1))),128))])]),t("td",{textContent:l(d.$filter.currency(r.total))},null,8,at),t("td",null,[t("div",ut,[D(t("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch-${r.id}`,"onUpdate:modelValue":i=>r.is_paid=i,onChange:i=>u.updatePaid(r)},null,40,pt),[[V,r.is_paid]]),t("label",{class:"form-check-label",for:`paidSwitch-${r.id}`},[r.is_paid?(s(),n("span",ht,"已付款")):(s(),n("span",_t,"未付款"))],8,ct)])]),t("td",null,[t("div",mt,[t("button",{class:"btn btn-outline-primary btn-sm",onClick:i=>u.openModal("view",r)},"檢視",8,bt),t("button",{class:"btn btn-outline-danger btn-sm",onClick:i=>u.openModal("delete",r)},"刪除",8,ft)])])])):_("",!0)],64))),128))])]),h(a,{pages:o.pagination,onSwitchPage:u.getOrders},null,8,["pages","onSwitchPage"])]),h(M,{active:o.isLoading,"onUpdate:active":e[0]||(e[0]=r=>o.isLoading=r)},null,8,["active"]),h(k,{order:o.tempOrder,ref:"modalOrder"},null,8,["order"]),h(x,{item:o.tempOrder,type:o.type,ref:"modalDelete",onUpdate:u.getOrders},null,8,["item","type","onUpdate"])],64)}const xt=y(Z,[["render",gt]]);export{xt as default};
