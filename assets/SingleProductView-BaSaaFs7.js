import{a as H}from"./axios-L6U4YIEh.js";import{_ as J,r as C,o as _,c as k,d as P,w as y,F as L,i as j,s as R,b as s,h as z,a as Q,t as S,j as F,g as B,n as U,e as q,l as G}from"./index-xTPydl-2.js";import{c as W}from"./cartStore-ZxUrRO6W.js";import{g as Z,i as ee,e as te,n as N,a as D,N as se,S as ie,b as oe,C as ne}from"./CarouselComponent-Ju1Vunbr.js";import{P as re}from"./ProductComponent-eDu9mFSA.js";import{s as X}from"./alertHelper-rCyq43OB.js";function ae(a){let{swiper:e,extendParams:T,on:b}=a;T({thumbs:{swiper:null,multipleActiveThumbs:!0,autoScrollOffset:0,slideThumbActiveClass:"swiper-slide-thumb-active",thumbsContainerClass:"swiper-thumbs"}});let o=!1,f=!1;e.thumbs={swiper:null};function g(){const i=e.thumbs.swiper;if(!i||i.destroyed)return;const t=i.clickedIndex,c=i.clickedSlide;if(c&&c.classList.contains(e.params.thumbs.slideThumbActiveClass)||typeof t>"u"||t===null)return;let d;i.params.loop?d=parseInt(i.clickedSlide.getAttribute("data-swiper-slide-index"),10):d=t,e.params.loop?e.slideToLoop(d):e.slideTo(d)}function v(){const{thumbs:i}=e.params;if(o)return!1;o=!0;const t=e.constructor;if(i.swiper instanceof t)e.thumbs.swiper=i.swiper,Object.assign(e.thumbs.swiper.originalParams,{watchSlidesProgress:!0,slideToClickedSlide:!1}),Object.assign(e.thumbs.swiper.params,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper.update();else if(ee(i.swiper)){const c=Object.assign({},i.swiper);Object.assign(c,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper=new t(c),f=!0}return e.thumbs.swiper.el.classList.add(e.params.thumbs.thumbsContainerClass),e.thumbs.swiper.on("tap",g),!0}function u(i){const t=e.thumbs.swiper;if(!t||t.destroyed)return;const c=t.params.slidesPerView==="auto"?t.slidesPerViewDynamic():t.params.slidesPerView;let d=1;const l=e.params.thumbs.slideThumbActiveClass;if(e.params.slidesPerView>1&&!e.params.centeredSlides&&(d=e.params.slidesPerView),e.params.thumbs.multipleActiveThumbs||(d=1),d=Math.floor(d),t.slides.forEach(m=>m.classList.remove(l)),t.params.loop||t.params.virtual&&t.params.virtual.enabled)for(let m=0;m<d;m+=1)te(t.slidesEl,`[data-swiper-slide-index="${e.realIndex+m}"]`).forEach(r=>{r.classList.add(l)});else for(let m=0;m<d;m+=1)t.slides[e.realIndex+m]&&t.slides[e.realIndex+m].classList.add(l);const p=e.params.thumbs.autoScrollOffset,x=p&&!t.params.loop;if(e.realIndex!==t.realIndex||x){const m=t.activeIndex;let r,M;if(t.params.loop){const n=t.slides.find(I=>I.getAttribute("data-swiper-slide-index")===`${e.realIndex}`);r=t.slides.indexOf(n),M=e.activeIndex>e.previousIndex?"next":"prev"}else r=e.realIndex,M=r>e.previousIndex?"next":"prev";x&&(r+=M==="next"?p:-1*p),t.visibleSlidesIndexes&&t.visibleSlidesIndexes.indexOf(r)<0&&(t.params.centeredSlides?r>m?r=r-Math.floor(c/2)+1:r=r+Math.floor(c/2)-1:r>m&&t.params.slidesPerGroup,t.slideTo(r,i?0:void 0))}}b("beforeInit",()=>{const{thumbs:i}=e.params;if(!(!i||!i.swiper))if(typeof i.swiper=="string"||i.swiper instanceof HTMLElement){const t=Z(),c=()=>{const l=typeof i.swiper=="string"?t.querySelector(i.swiper):i.swiper;if(l&&l.swiper)i.swiper=l.swiper,v(),u(!0);else if(l){const p=`${e.params.eventsPrefix}init`,x=m=>{i.swiper=m.detail[0],l.removeEventListener(p,x),v(),u(!0),i.swiper.update(),e.update()};l.addEventListener(p,x)}return l},d=()=>{if(e.destroyed)return;c()||requestAnimationFrame(d)};requestAnimationFrame(d)}else v(),u(!0)}),b("slideChange update resize observerUpdate",()=>{u()}),b("setTransition",(i,t)=>{const c=e.thumbs.swiper;!c||c.destroyed||c.setTransition(t)}),b("beforeDestroy",()=>{const i=e.thumbs.swiper;!i||i.destroyed||f&&i.destroy()}),Object.assign(e.thumbs,{init:v,update:u})}function le(a){let{swiper:e,extendParams:T,emit:b,once:o}=a;T({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function f(){if(e.params.cssMode)return;const u=e.getTranslate();e.setTranslate(u),e.setTransition(0),e.touchEventsData.velocities.length=0,e.freeMode.onTouchEnd({currentPos:e.rtl?e.translate:-e.translate})}function g(){if(e.params.cssMode)return;const{touchEventsData:u,touches:i}=e;u.velocities.length===0&&u.velocities.push({position:i[e.isHorizontal()?"startX":"startY"],time:u.touchStartTime}),u.velocities.push({position:i[e.isHorizontal()?"currentX":"currentY"],time:N()})}function v(u){let{currentPos:i}=u;if(e.params.cssMode)return;const{params:t,wrapperEl:c,rtlTranslate:d,snapGrid:l,touchEventsData:p}=e,m=N()-p.touchStartTime;if(i<-e.minTranslate()){e.slideTo(e.activeIndex);return}if(i>-e.maxTranslate()){e.slides.length<l.length?e.slideTo(l.length-1):e.slideTo(e.slides.length-1);return}if(t.freeMode.momentum){if(p.velocities.length>1){const h=p.velocities.pop(),w=p.velocities.pop(),K=h.position-w.position,O=h.time-w.time;e.velocity=K/O,e.velocity/=2,Math.abs(e.velocity)<t.freeMode.minimumVelocity&&(e.velocity=0),(O>150||N()-h.time>300)&&(e.velocity=0)}else e.velocity=0;e.velocity*=t.freeMode.momentumVelocityRatio,p.velocities.length=0;let r=1e3*t.freeMode.momentumRatio;const M=e.velocity*r;let n=e.translate+M;d&&(n=-n);let I=!1,E;const A=Math.abs(e.velocity)*20*t.freeMode.momentumBounceRatio;let V;if(n<e.maxTranslate())t.freeMode.momentumBounce?(n+e.maxTranslate()<-A&&(n=e.maxTranslate()-A),E=e.maxTranslate(),I=!0,p.allowMomentumBounce=!0):n=e.maxTranslate(),t.loop&&t.centeredSlides&&(V=!0);else if(n>e.minTranslate())t.freeMode.momentumBounce?(n-e.minTranslate()>A&&(n=e.minTranslate()+A),E=e.minTranslate(),I=!0,p.allowMomentumBounce=!0):n=e.minTranslate(),t.loop&&t.centeredSlides&&(V=!0);else if(t.freeMode.sticky){let h;for(let w=0;w<l.length;w+=1)if(l[w]>-n){h=w;break}Math.abs(l[h]-n)<Math.abs(l[h-1]-n)||e.swipeDirection==="next"?n=l[h]:n=l[h-1],n=-n}if(V&&o("transitionEnd",()=>{e.loopFix()}),e.velocity!==0){if(d?r=Math.abs((-n-e.translate)/e.velocity):r=Math.abs((n-e.translate)/e.velocity),t.freeMode.sticky){const h=Math.abs((d?-n:n)-e.translate),w=e.slidesSizesGrid[e.activeIndex];h<w?r=t.speed:h<2*w?r=t.speed*1.5:r=t.speed*2.5}}else if(t.freeMode.sticky){e.slideToClosest();return}t.freeMode.momentumBounce&&I?(e.updateProgress(E),e.setTransition(r),e.setTranslate(n),e.transitionStart(!0,e.swipeDirection),e.animating=!0,D(c,()=>{!e||e.destroyed||!p.allowMomentumBounce||(b("momentumBounce"),e.setTransition(t.speed),setTimeout(()=>{e.setTranslate(E),D(c,()=>{!e||e.destroyed||e.transitionEnd()})},0))})):e.velocity?(b("_freeModeNoMomentumRelease"),e.updateProgress(n),e.setTransition(r),e.setTranslate(n),e.transitionStart(!0,e.swipeDirection),e.animating||(e.animating=!0,D(c,()=>{!e||e.destroyed||e.transitionEnd()}))):e.updateProgress(n),e.updateActiveIndex(),e.updateSlidesClasses()}else if(t.freeMode.sticky){e.slideToClosest();return}else t.freeMode&&b("_freeModeNoMomentumRelease");(!t.freeMode.momentum||m>=t.longSwipesMs)&&(b("_freeModeStaticRelease"),e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses())}Object.assign(e,{freeMode:{onTouchStart:f,onTouchMove:g,onTouchEnd:v}})}const ue={props:{images:{type:Array,default:()=>[]}},data(){return{thumbsSwiper:null,modules:[se,ae,le]}},methods:{setThumbsSwiper(a){this.thumbsSwiper=a}},components:{Swiper:ie,SwiperSlide:oe}},ce={class:"item"},de={class:"item"};function me(a,e,T,b,o,f){const g=C("SwiperSlide"),v=C("Swiper");return _(),k(L,null,[P(v,{modules:o.modules,thumbs:{swiper:o.thumbsSwiper},navigation:!0,class:"product-main-swiper"},{default:y(()=>[(_(!0),k(L,null,j(T.images,(u,i)=>(_(),R(g,{key:i},{default:y(()=>[s("div",ce,[s("div",{class:"img",style:z({backgroundImage:`url(${u})`})},null,4)])]),_:2},1024))),128))]),_:1},8,["modules","thumbs"]),P(v,{modules:o.modules,class:"product-thumb-swiper",spaceBetween:"10",slidesPerView:"5",watchSlidesProgress:!0,freeMode:!0,onSwiper:f.setThumbsSwiper},{default:y(()=>[(_(!0),k(L,null,j(T.images,(u,i)=>(_(),R(g,{key:"thumb-"+i},{default:y(()=>[s("div",de,[s("div",{class:"img",style:z({backgroundImage:`url(${u})`})},null,4)])]),_:2},1024))),128))]),_:1},8,["modules","onSwiper"])],64)}const pe=J(ue,[["render",me]]);var fe={VITE_API_URL:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"product-api",BASE_URL:"/pure-aura/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:Y,VITE_API_PATH:$}=fe,he={data(){return{product:{},productId:null,contentType:"intro",productNum:1,recommendProduct:[]}},methods:{formateText(a){return(a||"").replace(/\n/g,"<br>")},changeNum(a){a==="minus"?this.productNum-=1:a==="plus"&&(this.productNum+=1)},getProduct(a){H.get(`${Y}/api/${$}/product/${a}`).then(e=>{this.product=e.data.product,this.getRecommendProducts(this.product.category)}).catch(e=>{X(e.response.data.message,!1),this.$router.push("/products")})},getRecommendProducts(a){H.get(`${Y}/api/${$}/products?category=${a}`).then(e=>{const{products:T}=e.data;this.recommendProduct=T}).catch(()=>{X()})},...Q(W,["addToCart"])},watch:{"$route.params.id":{handler(a){this.getProduct(a)},immediate:!0}},components:{ProductImageCarousel:pe,CarouselComponent:ne,ProductComponent:re},mounted(){this.productId=this.$route.params.id,this.getProduct(this.productId)}},be={class:"single-product-page no-banner"},ve={class:"container mb-5"},we={"aria-label":"breadcrumb"},Te={class:"breadcrumb"},ge={class:"breadcrumb-item"},_e=["textContent"],ye={key:0,class:"row top"},xe={class:"col-md-7 col-lg-6","data-origin":"left"},Se={class:"col-md-5 offset-lg-1 reveal","data-origin":"right"},Ce={class:"py-md-3 py-lg-5 d-flex h-100 flex-column justify-content-between"},Pe=["textContent"],Me=["textContent"],Ie=["innerHTML"],ke={class:"top-price"},Ee=["textContent"],Ae=["textContent"],Ve={class:"number-box mb-3"},Le=["disabled"],Be=["textContent"],Ne={class:"action-btns"},De={class:"list-unstyled tablink reveal","data-origin":"top"},Re={class:"container reveal"},Oe=["innerHTML"],He=["innerHTML"],je={class:"container"},ze={class:"product-carousel product-list reveal"};function Fe(a,e,T,b,o,f){const g=C("RouterLink"),v=C("ProductImageCarousel"),u=C("ProductComponent"),i=C("CarouselComponent");return _(),k("main",be,[s("div",ve,[s("nav",we,[s("ol",Te,[e[6]||(e[6]=s("li",{class:"breadcrumb-item"},[s("a",{href:"/"},"首頁")],-1)),s("li",ge,[P(g,{to:"/products"},{default:y(()=>e[5]||(e[5]=[B("全系列商品")])),_:1})]),s("li",{class:"breadcrumb-item active","aria-current":"page",textContent:S(o.product.title)},null,8,_e)])]),o.product.title?(_(),k("div",ye,[s("div",xe,[Array.isArray(o.product.imagesUrl)?(_(),R(v,{key:0,images:o.product.imagesUrl},null,8,["images"])):F("",!0)]),s("div",Se,[s("div",Ce,[s("div",null,[s("h4",{textContent:S(o.product.category)},null,8,Pe),s("h2",{textContent:S(o.product.title)},null,8,Me),s("div",{innerHTML:f.formateText(o.product.description),class:"des"},null,8,Ie),s("div",ke,[s("span",{class:"original-price",textContent:S("NT$"+a.$filter.currency(o.product.origin_price))},null,8,Ee),s("span",{class:"offer-price",textContent:S("NT$"+a.$filter.currency(o.product.price))},null,8,Ae)]),s("div",Ve,[s("button",{type:"button",onClick:e[0]||(e[0]=t=>f.changeNum("minus")),disabled:o.productNum===1},e[7]||(e[7]=[s("i",{class:"bi bi-dash-lg"},null,-1)]),8,Le),s("span",{textContent:S(o.productNum)},null,8,Be),s("button",{type:"button",onClick:e[1]||(e[1]=t=>f.changeNum("plus"))},e[8]||(e[8]=[s("i",{class:"bi bi-plus-lg"},null,-1)]))])]),s("div",Ne,[s("button",{type:"button",onClick:e[2]||(e[2]=t=>a.addToCart(o.product.id,o.productNum))},e[9]||(e[9]=[s("i",{class:"bi bi-cart3"},null,-1),B(" 加入購物車")])),P(g,{to:"/cart"},{default:y(()=>e[10]||(e[10]=[s("i",{class:"bi bi-bag-check"},null,-1),B(" 直接購物")])),_:1})])])])])):F("",!0)]),s("ul",De,[s("li",null,[s("button",{type:"button",class:U({active:o.contentType=="intro"}),onClick:e[3]||(e[3]=t=>o.contentType="intro")},"產品介紹",2)]),s("li",null,[s("button",{type:"button",class:U({active:o.contentType=="spec"}),onClick:e[4]||(e[4]=t=>o.contentType="spec")},"產品規格",2)])]),s("div",Re,[q(s("div",{class:"tabcontent",innerHTML:f.formateText(o.product.content)},null,8,Oe),[[G,o.contentType=="intro"]]),q(s("div",{class:"tabcontent",innerHTML:f.formateText(o.product.spec)},null,8,He),[[G,o.contentType=="spec"]])]),s("div",je,[s("div",ze,[e[11]||(e[11]=s("h3",{class:"recommend-title reveal","data-origin":"top"},"你可能有興趣...",-1)),P(i,{slides:o.recommendProduct,slidesPerView:1,spaceBetween:0,loop:!1,autoplay:!1,pagination:!1,breakpoints:{576:{slidesPerView:2,spaceBetween:20},992:{slidesPerView:3,spaceBetween:20}}},{default:y(({item:t})=>[P(u,{product:t},null,8,["product"])]),_:1},8,["slides"])])])])}const Je=J(he,[["render",Fe]]);export{Je as default};
